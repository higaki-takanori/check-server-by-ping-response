# check-server-by-ping-response

ping の応答によりサーバの状態を確認するプログラム

## 実行コマンド

### pipenv の環境構築

```
% pipenv install
% pipenv shell
```

### サーバの状態を確認

```
% python check_server_status.py
```

### 実行時のオプション

#### ログエラーの出力

ログファイルに想定したエラーが含まれていた場合、以下のオプションを True にすることで標準出力される。

```
# IS_VISUABLE_MISS_FORMAT
# True: LOGFILENAMEにあるログの形式ミスを表示する
# False:LOGFILENAMEにあるログの形式ミスを表示しない
IS_VISUABLE_MISS_FORMAT = True
```

#### 過負荷状態の検出の際に直近の ping 回数が少ない場合

直近 m 回の平均応答時間を求める際に、ping が n(< m) 回の場合、以下のオプションを True にすることで直近 n 回の平均応答時間を求める。

```
# do_less_last_overload
# True: 直近のping回数が少なくても合わせて実行
# False: 直近のping回数が少ない場合、過負荷状態を検出しない
do_less_last_overload = False
```

## 想定したログエラー

### 送信日時

ping の送信日時は以下のもの以外受け付けない。

- 年:1900~2999
- 月:01~12
- 日:01~31 # 存在しない日にちは受け付けない 例）2 月 31 日は存在しないため、受け付けない
- 時:00~23
- 分:00~59
- 秒:00~59

例）

2020 年 01 月 02 日 03 時 45 分 59 秒 # OK

**0200** 年 01 月 02 日 03 時 45 分 59 秒 # NG

2020 年 **13** 月 02 日 03 時 45 分 59 秒 # NG

2020 年 01 月 **59** 日 03 時 45 分 59 秒 # NG

2020 年 01 月 02 日 03 時 **60** 分 59 秒 # NG

2020 年 **02 月 31 日** 03 時 45 分 59 秒 # NG

2020 年 01 月 02 日 03 時 **-45** 分 **5a** 秒 # NG

### IP アドレス

IP アドレスは以下が対象範囲

- 0.0.0.0 ~ 255.255.255.255

サブネットマスクは 1-30 以外は受け付けません。

例）

192.168.10.1/24 # OK

192.168.10.1/**0** # NG

**256**.168.10.1/24 # NG

192.168.10.1/**31** # NG

### 応答時間

応答時間は 0 及び正の整数以外受け付けません

例）

20 # OK

0 # OK

**-9** # NG

**a** # NG
